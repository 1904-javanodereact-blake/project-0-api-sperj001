<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/3/w3.css">
<head>
        <style type = "text/css">
            body {
                background-color: 	#808080;
            }
           </style>
</head>
<body>
    <audio src="/resources/the_office_theme_song.wav" id="backmusic" loop="loop" autoplay="true"></audio>
    <script>
        window.onload = function(){
            document.getElementById('backmusic').play();
        }
    </script>
    <head> 
        <nav class="w3-bar w3-black">
            <img class="w3-bar-item" src="/resources/revature_logo.png" alt ="Revature Logo" width="148px" height="60px"/>
            <a><form action="/login/home" method="get"><button class="w3-button w3-bar-item" id="homebtn" type="submit">Home</button></form></a>
            <a><form action="/users/home" method="get"><button class="w3-button w3-bar-item" id="usersbtn" type="submit">Users</button></form></a>
            <a><form action="/reimbursements/home" method="get"><button class="w3-button w3-bar-item" id="usersbtn" type="submit">Reimbursements</button></form></a>
        </nav>
    </head>
    <body background-color= #808080>
        <center>
                <div class="imgcontainer">
                    <img src="/resources/update_reimbursement.jpg" alt="Avatar" class="avatar">
                </div>
                
                <div class="container">
                    <b>Update User</b>
                    <br>
                    <form id="userupdateform" action="/reimbursements/update/complete" method="POST">
                        <div class="container">
                            <br>
                            <label for="uid"><b>Reimbursement ID = </b></label><a id="RId"></a>
                            <br>
                            <br>
                            <label for="uusername"><b>Author</b></label>
                            <input type="text" id="Rauthor" name="author" required>
                            <br>
                            <label for="upsw"><b>Amount</b></label>
                            <input type="text" id="Ramount" name="amount" required>
                            <br>
                            <label for="ufn"><b>Date Submitted</b></label>
                            <input type="text" id="Rdatesub" name="dateSubmitted" required>
                            <br>
                            <label for="uln"><b>Date Resolved</b></label>
                            <input type="text" id="Rdateres" name="dateResolved" required>
                            <br>
                            <label for="uemail"><b>Resolver</b></label>
                            <input type="text" id="Rresolver" name="resolver" required>
                            <br>
                            <label for="urole"><b>Description</b></label>
                            <input type="text" id="Rdesc" name="description" required>
                            <br>
                            <label for="urole"><b>Type</b></label>
                            <input type="text" id="Rtype" name="type" required>
                            <br>
                            <label for="urole"><b>Status</b></label>
                            <input type="text" id="Rstatus" name="status" required>
                            <br>
                            <input type="hidden" id="2Id" name="reimbursementId" required>
                            <button type="submit">Update</button>
                        </div>
                    </form>
                    <script id="scriptstuff">
                        function crypt(str){
                            var input     = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
                            var output    = 'NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm';
                            var index     = x => input.indexOf(x);
                            var translate = x => index(x) > -1 ? output[index(x)] : x;
                            return str.split('').map(translate).join('');
                        }
                        urlString = (window.location.href);
                        queryParts = urlString.split('?:');
                        beforeQueryString = queryParts[1];
                        afterQueryString = crypt(beforeQueryString);
                        queryString = afterQueryString.split('&');
                        //remove crypt from DOM
                        console.log(queryString);
                        let idA = queryString[0].split("=");
                        let authorA = queryString[1].split("=");
                        let amountA = queryString[2].split("=");
                        let datesubA = queryString[3].split("=");
                        let dateresA = queryString[4].split("=");
                        let descA = queryString[5].split("=");
                        let statusA = queryString[6].split("=");
                        let typeA = queryString[7].split("=");
                        let resolverA = queryString[8].split("=");
                        //values to be read later
                        let id = idA[1];
                        let author = authorA[1];
                        let amount = amountA[1];
                        let datesub = datesubA[1];
                        let dateres = dateresA[1];
                        let desc = descA[1];
                        let status = statusA[1];
                        let type = typeA[1];
                        let resolver = resolverA[1];
                        //send these variables outside the script
                        window.onload = function(){
                            if(id != null)document.getElementById("RId").innerHTML = id;
                            if(id != null)document.getElementById("2Id").value = id;
                            if(author != null)document.getElementById("Rauthor").value = author;
                            if(amount != null)document.getElementById("Ramount").value = amount;
                            if(datesub != null)document.getElementById("Rdatesub").value = new Date(datesub*1);
                            if(dateres != null)document.getElementById("Rdateres").value = new Date(dateres * 1);
                            let Bremoved = desc.split("%20");
                            console.log(Bremoved);
                            let removed = (Bremoved[0] + " " + Bremoved[1]);
                            console.log(removed);
                            if(desc != null)document.getElementById("Rdesc").value = removed;
                            if(status != null)document.getElementById("Rstatus").value = status;
                            if(type != null)document.getElementById("Rtype").value = type;
                            if(resolver != null)document.getElementById("Rresolver").value = resolver;
                        }
                    </script>
                    <script>
                         var node = document.getElementById("scriptstuff");
                        if (node.parentNode) {
                        node.parentNode.removeChild(node);
                        }
                    </script>
                </div>
        </center>
    </body>
</body>
</html>
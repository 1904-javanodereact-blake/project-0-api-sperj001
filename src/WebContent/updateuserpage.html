<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/3/w3.css">
<head>
        <style type = "text/css">
            body {
                background-color: 	#808080;
            }
           </style>
</head>
<body>
    <audio src="/resources/the_office_theme_song.wav" id="backmusic" loop="loop" autoplay="true"></audio>
    <script>
        window.onload = function(){
            document.getElementById('backmusic').play();
        }
    </script>
    <head> 
        <nav class="w3-bar w3-black">
            <img class="w3-bar-item" src="/resources/revature_logo.png" alt ="Revature Logo" width="148px" height="60px"/>
            <a><form action="/login/home" method="get"><button class="w3-button w3-bar-item" id="homebtn" type="submit">Home</button></form></a>
            <a><form action="/users/home" method="get"><button class="w3-button w3-bar-item" id="usersbtn" type="submit">Users</button></form></a>
            <a><form action="/reimbursements/home" method="get"><button class="w3-button w3-bar-item" id="usersbtn" type="submit">Reimbursements</button></form></a>
        </nav>
    </head>
    <body background-color= #808080>
        <center>
                <div class="imgcontainer">
                    <img src="/resources/update_user.png" alt="Avatar" class="avatar">
                </div>
                
                <div class="container">
                    <b>Update User</b>
                    <br>
                    <form id="userupdateform" action="/users/update/complete" method="POST">
                        <div class="container">
                            <br>
                            <label for="uid"><b>User ID = </b></label><a id="IuserId"></a>
                            <br>
                            <br>
                            <label for="uusername"><b>Username</b></label>
                            <input type="text" id="Iusername" name="username" required>
                            <br>
                            <label for="upsw"><b>Password</b></label>
                            <input type="text" id="Ipassword" name="password" required>
                            <br>
                            <label for="ufn"><b>First Name</b></label>
                            <input type="text" id="Ifirstname" name="firstname" required>
                            <br>
                            <label for="uln"><b>Last Name</b></label>
                            <input type="text" id="Ilastname" name="lastname" required>
                            <br>
                            <label for="uemail"><b>Email</b></label>
                            <input type="text" id="Iemail" name="email" required>
                            <br>
                            <label for="urole"><b>Role</b></label>
                            <input type="text" id="Irole" name="role" required>
                            <br>
                            <input type="hidden" id="2userId" name="userId" required>
                            <button type="submit">Update</button>
                        </div>
                    </form>
                    <script id="scriptstuff">
                        function crypt(str){
                            var input     = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
                            var output    = 'NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm';
                            var index     = x => input.indexOf(x);
                            var translate = x => index(x) > -1 ? output[index(x)] : x;
                            return str.split('').map(translate).join('');
                        }
                        urlString = (window.location.href);
                        queryParts = urlString.split('?:');
                        beforeQueryString = queryParts[1];
                        afterQueryString = crypt(beforeQueryString);
                        queryString = afterQueryString.split('&');
                        //remove crypt from DOM
                        
                        
                        let useridA = queryString[0].split("=");
                        let usernameA = queryString[1].split("=");
                        let passwordA = queryString[2].split("=");
                        let firstnameA = queryString[3].split("=");
                        let lastnameA = queryString[4].split("=");
                        let emailA = queryString[5].split("=");
                        let roleA = queryString[6].split('=');
                        //values to be read later
                        let userid = useridA[1];
                        let username = usernameA[1];
                        let password = passwordA[1];
                        let firstname = firstnameA[1];
                        let lastname = lastnameA[1];
                        let email = emailA[1];
                        let role = roleA[1];
                        console.log(role, roleA[1], queryString[6], afterQueryString);
                        //send these variables outside the script
                        window.onload = function(){
                            document.getElementById("IuserId").innerHTML = userid;
                            document.getElementById("2userId").value = userid;
                            document.getElementById("Iusername").value = username;
                            document.getElementById("Ipassword").value = password;
                            document.getElementById("Ifirstname").value = firstname;
                            document.getElementById("Ilastname").value = lastname;
                            document.getElementById("Iemail").value = email;
                            document.getElementById("Irole").value = role;
                        }
                    </script>
                    <script>
                         var node = document.getElementById("scriptstuff");
                        if (node.parentNode) {
                        node.parentNode.removeChild(node);
                        }
                    </script>
                </div>
        </center>
    </body>
</body>
</html>